{"componentChunkName":"component---src-templates-blog-post-js","path":"/atWork/hide-pw-in-memory-1/","result":{"data":{"site":{"siteMetadata":{"title":"Today I Learned...","author":"장호현","siteUrl":"https://guest-01.github.io/TIL","comment":{"disqusShortName":"","utterances":"Guest-01/blog-comments"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"98c75b54-3562-58b4-9b8d-8c82df9720ff","excerpt":"※ 참고 저는 brave 브라우저를 사용하고 있어서, 작업관리자와 덤프 파일명에 라고 적혀있습니다만 chrome…","html":"<!-- ### TL;DR (요약)\n\n1. 사용자 입력을 하나하나 바꿔치기 한다.\n2. 절대 비밀번호를 문자열로 가지고 있지 않는다.\n3. 2번을 지키기 위해 백엔드에 보낼때도 해시로 보낸다. -->\n<h3 id=\"-참고\" style=\"position:relative;\"><a href=\"#-%EC%B0%B8%EA%B3%A0\" aria-label=\" 참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>※ 참고</h3>\n<blockquote>\n<p>저는 <a href=\"https://brave.com/ko/\">brave</a> 브라우저를 사용하고 있어서, 작업관리자와 덤프 파일명에 <code class=\"language-text\">brave</code>라고 적혀있습니다만 chrome 브라우저를 사용해도 내용은 동일합니다.</p>\n</blockquote>\n<h2 id=\"문제의-시작\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C%EC%9D%98-%EC%8B%9C%EC%9E%91\" aria-label=\"문제의 시작 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제의 시작</h2>\n<p>사내 솔루션의 보안 평가를 진행하던 중 지적 사항으로 사용자가 입력한 패스워드가 메모리에 평문으로 남는다는 지적이 있었습니다. 개인적으로는 아직도 잘 이해가 되지 않는 지적입니다. 백엔드 데이터베이스도 아니고, 프론트엔드에서 저런 지적을 받아야한다니…</p>\n<p>요점은 사용자가 비밀번호를 입력하여 로그인 하고, 서비스 사용을 모두 마친 후 로그아웃 했을 때는 브라우저 메모리에 비밀번호가 남아있지 않아야 한다는 것이었습니다.</p>\n<p>얼핏 들으면 맞는 말인 것 같습니다. 브라우저라는 것이 우리 솔루션/서비스만을 위한 프로그램이 아닌데, 우리 서비스의 이용이 끝나도 민감 정보를 가지고 있다는 것이 관점에 따라서는 애매할 수 있지요.</p>\n<p>하지만 그렇다 할지라도 그것은 브라우저 개발자들이 고민할 문제가 아닐까요? 브라우저 메모리의 안전성을 브라우저 개발자도, OS 개발자도 아닌 서비스/솔루션 개발자인 우리가 왜 대비해야할까요?</p>\n<p>이 문제를 풀어보려 머리를 쥐어짜낼 수록 위와 같은 생각은 커져만 갔습니다. 대체 왜… 그러나 사내에는 이런 문제에 대해 납득 가능한 설명이나 도움을 줄 수 있는 분도 없었고, 그저 기한 내에 보안 평가를 마쳐야한다는 목표만 있을 뿐이었죠.</p>\n<h2 id=\"테스트-방법\" style=\"position:relative;\"><a href=\"#%ED%85%8C%EC%8A%A4%ED%8A%B8-%EB%B0%A9%EB%B2%95\" aria-label=\"테스트 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>테스트 방법</h2>\n<p>윈도우 환경에서 작업관리자를 켜면 아래와 같이 원하는 프로세스의 메모리 덤프파일을 만들 수 있습니다.</p>\n<blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 666px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADhklEQVQ4y51U2W7bVhDlF/cD+hUBCjTpQx4KIzGKIItb261V23BcOwmSAk6sSpRIcd/3VVwlns6l1AAt/NQLDIcE75yZMxunGQY0TYdl2ajrGlVVoet6ku5BYXfquhl10zTj/TzPUZYlPM8DJ4oCvbgwCNiyLDiOgziOR0nTFFmWIUmS8b0ocuzOsHsOw/5zp9frNTh2qeva0ZAZMW9RFH0FZBLH0f5fQRHV2GzJmPR2O6BtW7TEiGEyGy6MEmz3jv57KqK2Ydb7qIahh+97aNYJDE1E11ajszwnp0kMwzTAMdQo8BH6PtqGvG7I23Yz6k3f778JrouxzW+w9n5Hcvct3Ntv0PtHiIxzNNEVcnsCeXEOLidATxTBax6WqoMgp8JsiFIPlB1QtFsUpNOqRJ7ewbXfwVR/wWL6HEn4AYp0RcF8gqVfg59fUw4pLx7P416yMSXR3Qj3CwmfZyJUO4CflNC9DHZMtFIeuvEndP0K0+kRvOAzlsItHO8LZOU9FsuP4Np1gV7hYbEqmzryOICtK5CWM8SBi74ukBGLvnIpbEbtGKX1I+Qvj9DHp3BXr9GEEyTaGyiLM3BNWaBVhbFdTNvBWyHGq486XrwT8fK9hDM+xaVAfVZ4lIMbZM4ZgR5CnT1GG0/gKceow0skxgk04XIPKM2gqhqJCtEK8Wmu4MO9gJs7HnMtwMrOUJUM8A/E5gkK+znEu++oGGcwhTeoggsEyhEkfgKuZoAai9CF67rIkpASLUISFtAVGfU6p2Jk1CoM8BY5RVh5hzD4J2OEvnKCOqIIyZEmXoALsgKSE8Enyg4B2raN2WwOSZbh0iixJnfcAHXpYiguCfCY6B1A/et7tNEpUX5NlM+RWqcESJSTLIcTptSLIRnHY5RsBH3qSza7DfVm026waX00wUvE+iFS8wDm4gfqyRfwpAMC/BWlO4ElX4Hzqe+mdoHIY5Qpojh5cGqGPsWQX6P0JsjMZ9BnT9AR5UDdUf4aYVqkMKk9Qj8Yt0WW5Q/P4TYbi7L2J1SUZzD5x+iSCSL9hIpDqbBPYawIMI4CWDZbYVRlEgbK1tI/62mne8qhQxR/JoBXRPknaPOnBHQBX/2NIrxG7p5DX70FZxgmJEWFLEk0ATpM0xx78t/iwrEtJLFHiyCiNcbWWYR1mSHPEsq9T/8JR1qBYzuMrSym/+9hnSDLCpZLAX8DAmw5mp4w1V4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"윈도우작업관리자메모리덤프\"\n        title=\"윈도우작업관리자메모리덤프\"\n        src=\"/TIL/static/d9e90f84227503c09ab443c66a4d6eeb/ace37/make-mem-dump-file.png\"\n        srcset=\"/TIL/static/d9e90f84227503c09ab443c66a4d6eeb/5a46d/make-mem-dump-file.png 300w,\n/TIL/static/d9e90f84227503c09ab443c66a4d6eeb/0a47e/make-mem-dump-file.png 600w,\n/TIL/static/d9e90f84227503c09ab443c66a4d6eeb/ace37/make-mem-dump-file.png 666w\"\n        sizes=\"(max-width: 666px) 100vw, 666px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n</blockquote>\n<p>만들어진 덤프파일은 <code class=\"language-text\">C:\\Users\\{사용자명}\\AppData\\Local\\Temp</code> 경로에 <code class=\"language-text\">프로세스 이름.DMP</code> 파일로 저장됩니다.</p>\n<p>이 덤프파일을 <a href=\"https://mh-nexus.de/en/hxd/\">HxD</a> 같은 Hex 에디터로 열어서 검색해보면 메모리를 조사해볼 수 있습니다.</p>\n<blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 1084px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACZElEQVQ4y6VTy27TQBT1LyDxC+xAqAt2FQIWSN3wA2xY8Rcg8QkV67Soal7No5HYAruwoU2aVkrSOO+XycsZO3Zip3YO946bqEVhxZWO5mYmc3zuuXcU09Qxn8+xWCzguq5c+fcaq9UK28Knfc/z4fv+7T0Hw9EIykUhj3z+HGfneVxdXaFQKCCXy+Hy8nKDUqkEVVVRqVQkRsMBbGsGb+nCdRwsCJ53A13XoYTDYUSjMUIUkUhEgvOjoyMcHBxIhEKhDb4cHqJUbaCljTEQNkw7qG65XGIymUA5OTlBMplEIpGQ4DwWj+NnNot6rYZqtYoaraywXC6jSGrrmo6sOkE0Z+BMFbAMXdow4pLjdJmJmDggTCAciaLZVOHYhvRlPB7LC/uf9/Hi1S72Xr9E4eIcvgf6qMBg0Jfn/X5/G2ESbEOv14MhBKmrYkCeURfw9v07PNl5iDfPHuDbj++SpN4QGA5/y1zTtO2Ex8dhOuzDsgC1wmb78sKHTx/x+OkjPN/doSb+okaAPiio1IBQeriNkBvDvhmGRWbzeASjY9MY9dpVVM6+Qkw0Giug0zGpAk2eT6fToCnrhqwJucvcAMtiQhoN14HjuLi5IbXCRLM/hFprQIgpkdrk4eBWIY3NekwYsVhMgvNUKoVMJoN0Or0B76VPT1FW6+h0e1IRD/9sNpOEpmlC4UFmNdfX1ygWi2i1Wuh2u2i32zLn9S5azSbEVJfqbdsm5Q6WpJxfjKAmKnywDi7pHy/tXqyfqXyCRORxdygMw7xP+L/BXIquBz6w/ADzO7i7Z/+1Z9/7H5c+HI3xB8lz45iJN/FYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"hxd-about\"\n        title=\"hxd-about\"\n        src=\"/TIL/static/7de7bb64babcafc3eae4f17a0a9c4cb0/48ca3/hxd-about.png\"\n        srcset=\"/TIL/static/7de7bb64babcafc3eae4f17a0a9c4cb0/5a46d/hxd-about.png 300w,\n/TIL/static/7de7bb64babcafc3eae4f17a0a9c4cb0/0a47e/hxd-about.png 600w,\n/TIL/static/7de7bb64babcafc3eae4f17a0a9c4cb0/48ca3/hxd-about.png 1084w\"\n        sizes=\"(max-width: 1084px) 100vw, 1084px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n</blockquote>\n<p>따라서 브라우저에서 비밀번호를 입력하고 작업관리자에서 브라우저 프로세스의 덤프파일을 뜬 뒤, HxD 에디터로 열어서 검색(<code class=\"language-text\">Ctrl + F</code>)했을 때 비밀번호가 검색되면 안되는 것입니다.</p>\n<h2 id=\"언제-그리고-무엇을-하면-메모리에-저장되는가\" style=\"position:relative;\"><a href=\"#%EC%96%B8%EC%A0%9C-%EA%B7%B8%EB%A6%AC%EA%B3%A0-%EB%AC%B4%EC%97%87%EC%9D%84-%ED%95%98%EB%A9%B4-%EB%A9%94%EB%AA%A8%EB%A6%AC%EC%97%90-%EC%A0%80%EC%9E%A5%EB%90%98%EB%8A%94%EA%B0%80\" aria-label=\"언제 그리고 무엇을 하면 메모리에 저장되는가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>언제, 그리고 무엇을 하면 메모리에 저장되는가</h2>\n<p>일단, 메모리에 비밀번호가 남는 시점을 파악할 필요가 있었습니다. 저희 솔루션을 포함한 여느 웹사이트이던 비밀번호가 입력되고 처리되는 과정은 아래와 같습니다.</p>\n<ol>\n<li>사용자가 <code class=\"language-text\">&lt;input></code> 태그에 비밀번호를 입력</li>\n<li>javascript에서 DOM 조작을 통해 가져온 후 사용</li>\n</ol>\n<h3 id=\"1-사용자가-code-classlanguage-textltinputcode-태그에-비밀번호를-입력\" style=\"position:relative;\"><a href=\"#1-%EC%82%AC%EC%9A%A9%EC%9E%90%EA%B0%80-code-classlanguage-textltinputcode-%ED%83%9C%EA%B7%B8%EC%97%90-%EB%B9%84%EB%B0%80%EB%B2%88%ED%98%B8%EB%A5%BC-%EC%9E%85%EB%A0%A5\" aria-label=\"1 사용자가 code classlanguage textltinputcode 태그에 비밀번호를 입력 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 사용자가 <code class=\"language-text\">&lt;input></code> 태그에 비밀번호를 입력</h3>\n<p>아래와 같이 <code class=\"language-text\">&lt;input></code> 태그만 있는 html을 만들어서 입력칸에 여러가지 값을 넣은 후 덤프를 조사해보았습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pwInput<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>여러번의 테스트를 거쳐, 알게된 사실은 아래와 같습니다.</p>\n<ul>\n<li><code class=\"language-text\">input</code> 칸이 focus를 잃는 순간(<code class=\"language-text\">blur</code>) 입력 되어있는 값이 메모리에 저장됩니다.</li>\n<li>그렇게 한번 저장된 값은 다시 클릭하여 수정해도 여전히 메모리에 남아있습니다. (새로 수정한 값도 같이 남습니다)</li>\n</ul>\n<p>일반적으로 로그인-로그아웃 과정에서 비밀번호를 입력한 후 “로그인” 버튼을 누르기 때문에 그때 <code class=\"language-text\">blur</code> 이벤트가 발생하므로 이 부분부터 해결 방법을 찾아야합니다. 굳이 “로그인” 버튼을 클릭하지 않더라도, 다른 요소(아이디를 다시 누른다던지, 혹은 화면의 아무 빈 곳이라도)을 클릭하여 focus를 잃을 수 있기 때문에 단순히 로그인 버튼을 없애고 enter키 등을 사용하도록 유도한다고 해서 해결될 문제가 아니었습니다.</p>\n<p>우선 이 부분을 해결했다고 가정하고 이어서 javascript 사용시에는 메모리에 남기지 않는 것이 가능한 지 확인해보겠습니다.</p>\n<h3 id=\"2-javascript에서-dom-조작을-통해-가져온-후-사용\" style=\"position:relative;\"><a href=\"#2-javascript%EC%97%90%EC%84%9C-dom-%EC%A1%B0%EC%9E%91%EC%9D%84-%ED%86%B5%ED%95%B4-%EA%B0%80%EC%A0%B8%EC%98%A8-%ED%9B%84-%EC%82%AC%EC%9A%A9\" aria-label=\"2 javascript에서 dom 조작을 통해 가져온 후 사용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. javascript에서 DOM 조작을 통해 가져온 후 사용</h3>\n<p>사용자가 입력한 아이디/비밀번호를 이용해 서버에 로그인하려면 자바스크립트로 해당 값을 가져와야합니다.</p>\n<p>일반적으로는 로그인 버튼을 눌렀을 때 <code class=\"language-text\">input</code>의 값을 가져오도록 코드를 짜겠지만, 위 사례에서 우리는 그렇게 하면 메모리에 이미 남아버린다는 것을 알았습니다. (버튼을 누르는 순간 input의 focus를 잃어버리기 때문) 그래서 <code class=\"language-text\">oninput</code> 이벤트를 이용해서 focus를 잃지않고 값을 가져와 사용해보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pw<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>pwInput<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">oninput</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>handleInput(event)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n        <span class=\"token keyword\">const</span> pwInput <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#pwInput\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">let</span> pw<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">function</span> <span class=\"token function\">handleInput</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            pw <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>결과는 focus를 잃지 않고 입력했던 값을 지워도 모든 값이 메모리에 남아있었습니다. 이전에는 focus가 잡혀있는 동안에는 굳이 메모리 어딘가에 저장해놓지 않았던 것이, 이제는 input 이벤트가 발생할 때마다 변수(<code class=\"language-text\">pw</code>)에 값을 저장하기 때문에 메모리에 들어가는 것 같았습니다. 그런데 그렇다 하더라도 <strong>같은 변수에 계속 덮어쓰고 있는데</strong> 왜 이전에 입력했던 값까지도 메모리에 남기는 걸까요?</p>\n<p>이는 자바스크립트 언어 구현에 따른 증상으로 추정되는데, 브라우저 엔진마다 다를 수 있기에 정확하게 확인하기는 어렵지만 <strong>추정</strong>은 아래와 같이 해볼 수 있습니다.</p>\n<ul>\n<li>문자열을 할당할 때 문자열을 heap에 만들고 해당 위치(포인터)를 변수에 저장합니다.</li>\n<li>다른 문자열로 덮어쓰면 동일 위치에 값을 변경하는 것이 아니라, 다른 위치에 새 문자열을 만들고 변수의 포인터를 변경합니다.</li>\n</ul>\n<p>문제는 자바스크립트는 개발자에게 메모리 관리를 맡기지 않으며, 포인터나 GC를 직접 다룰 수 없도록 감춰져 있습니다. 따라서 한번 사용한 문자열을 확실하게 지울 수 있는 방법이 없다는 것입니다. 따라서 이전 문자열이 언제 메모리에서 지워질지는 전적으로 엔진과 OS에 달려있습니다.</p>\n<p>그렇다면 이 문제를 어떻게 해결해야할까요? 해결 불가능한 문제인 것일까요? 분명 저에게만 이런 요구사항이 주어진 것이 아니리라는 생각이 들었기에 참고해볼 레퍼런스를 찾아보았습니다. 일반인이 접근할 수 있는 사이트 중 보안이 제일 엄격한 곳이 어딜까요? 아마 은행 웹사이트일 것입니다. 저는 이어서 은행 웹사이트들이 비밀번호를 어떻게 처리하고 있는지를 확인해보았습니다.</p>\n<p>(다음 글에 계속)</p>","frontmatter":{"title":"비밀번호를 브라우저 메모리에서 숨기기 (1)","date":"November 06, 2022"}}},"pageContext":{"slug":"/atWork/hide-pw-in-memory-1/","previous":{"fields":{"slug":"/atWork/web-security-with-arahcni/"},"frontmatter":{"title":"Arachni로 웹 취약점 개선하기"}},"next":null}}}